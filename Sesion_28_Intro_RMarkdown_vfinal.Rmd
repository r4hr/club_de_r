---
title: "Relevamiento Parcial Sueldos de RRHH Argentina"
subtitle: "Club de R para RRHH"
author: "Sergio Garcia Mora"
date: "Noviembre 2020"
output: 
  html_document:
    theme: spacelab
    highlight: pygments
    toc: true
    toc_float: true
    code_download: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, dpi=200)
```

```{r librerias-datos}
library(tidyverse)
library(gargle)
library(googlesheets4)
library(funModeling)
library(gt)
library(scales)

# Estilo de los gr치ficos
estilo <- theme(panel.grid = element_blank(),
                plot.background = element_rect(fill = "#FBFCFC"),
                panel.background = element_blank())

# Este es un objeto que vamos a utilizar para no tener que tipear siempre lo mismo
fuente <- "Fuente: Encuesta KIWI de Sueldos de RRHH"


# Colores predefinidos de los gr치ficos
col_genero <- c("#8624F5", "#1FC3AA")
col_graf <- "#5DADE2"

# Carga de los sueldos
sueldos <- read_delim("https://raw.githubusercontent.com/r4hr/club_de_r/master/Datos/encuesta_sueldos.csv", delim = ",")


# Filtramos los sueldos entre los percentiles 5 y 95
resumen_numerico <- profiling_num(sueldos)
percentil_05 <- resumen_numerico[6,6]
percentil_95 <- resumen_numerico[6,10]

# Limpiamos un poco m치s el dataset
sueldos <- sueldos %>% 
  filter(between(sueldo_bruto, percentil_05, percentil_95), 
         aumento < 100,
         anios_rh < 40,
         puesto != "Director")
```

Este es un ejercicio de pr치ctica, realizado durante el curso **"Introducci칩n a R para RRHH"** de [Data 4HR](https://data-4hr.com). Si quieren saber m치s, pueden contactarme en [mi perfil en LinkedIn](https://www.linkedin.com/in/sergiogarciamora/) o por [Twitter](https://twitter.com/sergiogarciamor) 游.

Los datos utilizados son una muestra de la Encuesta KIWI de Sueldos de RRHH de Latam realizado por el [Club de R para RRHH](https://r4hr.club)游볳.

Este es un ejemplo de reporte que se puede hacer utilizando R, con el paquete `RMarkdown`.

# An치lisis de sueldos de RRHH por puesto

```{r puestos}
sueldos <- sueldos %>% 
  mutate(puesto = factor(puesto, 
                         levels = c("Administrativo", "Analista", "HRBP", 
                                    "Responsable", "Jefe", "Gerente"))) 

puestos <- sueldos %>% 
  group_by(puesto) %>% 
  summarise(sueldo_promedio = mean(sueldo_bruto))

ggplot(puestos, aes(x = sueldo_promedio, 
                    y = reorder(puesto, sueldo_promedio))) +
  geom_col(fill = "#5DADE2") +
  labs(title = "Sueldo promedio por puesto",
       subtitle = "En AR$",
       x = "", y="",
       caption = fuente) +
  estilo +
  scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ";")) +
  theme(panel.grid.major.x = element_line(colour = "#CACFD2"))
```

Para realizar este gr치fico filtramos los sueldos por encima de `r paste0("AR$ ",comma(percentil_05, big.mark = ".", decimal.mark = ";"))` (percentil 5), y por debajo de `r paste0("AR$ ",comma(percentil_95, big.mark = ".", decimal.mark = ";"))` (percentil 95).

## Tabla de Sueldos

```{r}
salarios <- sueldos %>% 
  mutate(puesto = factor(puesto, 
                         levels = c("Gerente", "Jefe", "Responsable",
                                     "HRBP", "Analista", "Administrativo"))) 

puestos2 <- salarios %>% 
  group_by(puesto) %>% 
  summarise(sueldo_promedio = mean(sueldo_bruto))

gt(puestos2) %>% 
  tab_header(title = "Sueldo promedio por puesto") %>% 
  cols_label(puesto = "Puesto", 
             sueldo_promedio = "Sueldo Promedio") %>% 
  fmt_currency(columns = c("sueldo_promedio"),
               currency = "ARS",
               decimals = 0)
  
```

## Dispersi칩n de sueldos por puesto y g칠nero

En este *boxplot* podemos apreciar las amplitudes en los sueldos de cada puesto por g칠nero. Mientras m치s larga sea la caja, m치s amplia es la variaci칩n de los sueldos, y al contrario, mientras m치s chica sea la caja, hay una mayor concentraci칩n de los sueldos.

A los puntos que aparecen por encima de cada uno de los gr치ficos, se los denomina `outlier`, y son valores extremos.

```{r}
ggplot(salarios, aes(x = puesto, y = sueldo_bruto, fill = genero)) +
  geom_boxplot() +
  labs(title = "Dispersi칩n de sueldos por puesto y g칠nero",
       x = "", y = "",
       caption = fuente, 
       fill = "G칠nero") +
  scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
  scale_fill_manual(values = col_genero) +
  estilo +
  theme(panel.grid.major.y = element_line(colour = "#CACFD2"))

```

Este tipo de gr치ficos, los *boxplots*, proveen de mucha informaci칩n estad칤stica.

-   El l칤mite inferior de la caja es el 1춿 cuartil (1Q).
-   La l칤nea dentro de la caja, es la mediana.
-   El l칤mite superior de la caja es el 3춿 cuartil (3Q).
-   Las l칤neas que salen de la caja son los l칤mites para indicar los valores outliers y se calculan **1,5 por el Rango Intercuartil (3Q - 1Q)**.
-   Los puntos que vemos m치s all치 de las l칤neas son *outliers*.

Por ejemplo, este gr치fico nos permite ver que en el caso de los gerentes, no hay una diferencia muy amplia en la **mediana** de los sueldos de hombres y mujeres. En cambio vemos que la caja del gr치fico de las mujeres es m치s amplia que la de los varones. Esto quiere decir que hay una porci칩n de mujeres como Gerente de RRHH que cobran menos que sus pares hombres, y que tambi칠n hay una porci칩n de mujeres que cobran m치s que los varones.

## Relaci칩n entre a침os de experiencia y sueldo

Con el siguiente gr치fico queremos ver cu치l es la relaci칩n entre los a침os de experiencia y el sueldo bruto.

```{r}
modelo_lineal <- broom::tidy(lm(data = sueldos, 
                                sueldo_bruto ~ anios_rh))

modelo_lineal$estimate <- dollar(modelo_lineal$estimate,
                                 prefix = "AR$ ",    # Podemos controlar el s칤mbolo utilizado
                                 big.mark = ".",     # Cambia el separador de miles
                                 decimal.mark = ",") # Cambia el separador decimal


ggplot(sueldos, aes(x = anios_rh, y = sueldo_bruto)) +
  geom_point(alpha = .7, size = 1.5, color = col_graf) +
  geom_smooth(method = "lm") +
  labs(title = "Relaci칩n entre a침os de experiencia y sueldos de RRHH",
       subtitle = "En pesos argentinos",
       x = "A침os de Experiencia",
       y = "Sueldo Bruto",
       caption = fuente) +
  scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
  estilo
```

Podemos ver una relaci칩n positiva entre los a침os de experiencia y el sueldo, es decir que a medida que aumentan los a침os de experiencia (nos movemos hacia la derecha en el eje horizontal), sube el sueldo bruto (en el eje vertical).

En promedio, una persona con cero a침os de experiencia en RRHH cobra un sueldo bruto de `r modelo_lineal[1,2]`. Y con cada a침o de experiencia, el sueldo aumenta en `r modelo_lineal[2,2]`.

# Ratio de Empleados de RRHH por Dotaci칩n

Con este indicador queremos analizar la cantidad de empleados que hay en el 치rea de RRHH en relaci칩n a la dotaci칩n de la empresa.

```{r ratio}

 ratio <- sueldos %>% 
  select(rubro, empleados, empleados_rh) %>% 
  mutate(ratio_rh_dotacion = empleados/empleados_rh) %>% 
  group_by(rubro) %>% 
  summarise(ratio_promedio = round(mean(ratio_rh_dotacion))) %>% 
  filter(ratio_promedio != Inf) 

ggplot(ratio, aes(x=ratio_promedio, 
                         y = reorder(rubro, ratio_promedio)))+
  geom_point(color = col_graf, size = 4)+
  geom_segment(aes(y = rubro, yend= rubro, x=0, xend=ratio_promedio),
               color="#5D6D7E") +
  estilo +
  labs(title="Ratio de Empleados de RH \n por Dotaci칩n",
       subtitle = "Detallado por rubro de la empresa", 
       caption = fuente, 
       x="", y= "") +
  theme(panel.grid.major.x = element_line(colour = "#CACFD2"))
```

# Agradecimientos

Agradezco a todos los participantes del curso **"Introducci칩n a R para RRHH"** que dictamos en [Data 4HR](https://data-4hr.com). Para conocer nuestras pr칩ximas fechas, y todas nuestras actividades de formaci칩n pod칠s entrar en [este link](https://www.curselo.com.ar/data4hr) o por mail a [sergio\@d4hr.com](mailto:sergio@d4hr.com).

Este es un curso en castellano, que utiliza datos de RRHH, para facilitar el aprendizaje del uso de este lenguaje de an치lisis de datos.

Y si ya sab칠s algo de R y te interesa ser parte de una comunidad de R enfocada en RRHH, te invitamos a seguirnos en el [Club de R para RRHH](https://r4hr.club).

<br>

![](https://i.creativecommons.org/l/by-nc/4.0/88x31.png)

<br><br><br>
