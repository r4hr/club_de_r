---
title: "02 Salarios RH Completo"
author: "Sergio | R4HR"
date: "2023-07-07"
output: 
  powerpoint_presentation:
    reference_doc: r4hr.potx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.retina = 3)

# Librer칤as ----

# Si no est치n instalados los paquetes usar el siguiente c칩digo
# install.packages("tidyverse")
# install.packages("flextable")

# Cargar los paquetes ----
library(tidyverse)
library(flextable)

# Colores para gr치ficos ----
verde <-  "#1FC3AA"
lila <- "#8624F5"
azul <- "#306DE6"


# Carga de Datos -----
rh <- read.csv("https://raw.githubusercontent.com/r4hr/club_de_r/master/Sesion_38_PowerPoint/kiwi22_clean.csv",
               sep = ";") # Indica el separador de columnas
```

# Introducci칩n

Para esta sesi칩n vamos a realizar un an치lisis sencillo, utilizando los datos de la **3춿 Encuesta KIWI de Sueldos de RH** 游볳 desarrollada por R4HR, el cual cuenta con `r nrow(rh)` respuestas de colegas bajo relaci칩n de dependencia.

![](https://img.freepik.com/fotos-premium/caracter-kiwi-kawaii_658005-700.jpg?w=2000){width="291"}

# An치lisis

## Mediana Salarial por Funci칩n

```{r grafico1}

# Calcular la mediana salarial por funci칩n
analisis1 <- rh %>% 
  group_by(funcion) %>% 
  summarise(sueldo_mediana = median(sueldo_dolar))

# Graficamos
ggplot(analisis1,                                   # Fuente de Datos
       aes(x = sueldo_mediana,                      # Columna mapeada al eje x  
           y = reorder(funcion, sueldo_mediana))) + # Columna mapeada al eje y
  geom_col(fill = azul) +                           # Tipo de gr치fico y color de relleno
  geom_text(aes(label = round(sueldo_mediana, 0)),  # Etiqueta de Datos
            hjust = 1.2,
            size = 3,
            color = "white") +
  labs(title = "Mediana Salarial por Funci칩n",      # Edita t칤tulos y ejes
       subtitle = "Sueldos en U$S",
       x = "Mediana Salarial en U$S",
       y = "Funci칩n",
       caption = "Fuente: Encuesta KIWI Sueldos de RH 2022") +
  theme_minimal()                                   # Modifica la est칠tica del gr치fico
  


```

## Sueldo Promedio por Puesto

:::::: {.columns}
::: {.column width="60%"}

Desde R Markdown podemos tener una columna con un gr치fico.

```{r grafico2}

# Calcular la mediana salarial por puesto
analisis2 <- rh %>% 
  group_by(puesto, genero) %>% 
  summarise(sueldo_mediana = round(median(sueldo_dolar),0)) %>% 
  ungroup()


ggplot(analisis2,                             # Fuente de datos
       aes(x = puesto,                        # Columnas a graficar
           y = sueldo_mediana, 
           fill = genero)) + 
  geom_col(position = "dodge") +              # Tipo de gr치fico y posici칩n de barras
  # Edito t칤tulos, ejes y pie de p치gina del gr치fico
  labs(title = "Mediana Salarial por Puesto",
       x = "Puesto", y = "Mediana Salarial",
       fill = "G칠nero", 
       caption = "Fuente: Encuesta KIWI de Sueldos de RH 2022") +
  theme_minimal() +        # Modifica la est칠tica del gr치fico
  scale_fill_manual(values = c(verde, lila)) + # Cambia colores a barras
  geom_text(aes(label = round(sueldo_mediana,0)),
            vjust = 1.2,
            position = position_dodge(.9),
            size = 3,
            color = "white")
```
:::
::: {.column width="40%"}

Y otra columna con una tabla por ejemplo.
```{r}
# Hacer una tabla
tabla1 <- analisis2 %>% 
  pivot_wider(id_cols = puesto, 
              names_from = genero,
              values_from = sueldo_mediana) %>% 
  rename(Puesto = puesto)

# Hacer tabla con el paquete flextable
flextable(tabla1) %>% 
  theme_vanilla() %>% 
  set_table_properties(layout = "autofit") %>% 
  add_header_row(values = c("", "G칠nero"),
                 colwidth = c(1,2)) %>% 
  align(i = 1, part = "header", align = "center")
```

:::
::::::
